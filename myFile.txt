this is code from from mac 
